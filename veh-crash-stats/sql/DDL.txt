-- Since data we have is just for ohio, probably best to organize using state code as schema
create schema oh;

CREATE TABLE oh.crash_statistics (
    local_report_number varchar,
    document_number varchar,
    crash_severity varchar,
    hit_skip varchar,
    local_information varchar,
    secondary_crash boolean,
    photos_taken boolean,
    oh2 boolean,
    oh3 boolean,
    oh1p boolean,
    oh_other boolean,
    private_property boolean,
    reporting_agency_ncic varchar,
    number_of_units integer,
    unit_in_error integer,
    county varchar,
    in_city_village_township varchar,
    city_village_township_name varchar,
    crash_datetime timestamptz,
    fips_place_code integer,
    latitude decimal(10,6),
    longitude decimal(10,6),
    location_route_type varchar,
    location_route_number varchar,
    location_prefix varchar,
    location_road_name varchar,
    location_road_type varchar,
    distance_from_reference decimal(10,2),
    distance_reference_measurement varchar,
    direction_from_reference varchar,
    reference_route_type varchar,
    reference_route_number varchar,
    reference_prefix varchar,
    reference_name varchar,
    reference_point_used varchar,
    reference_road_type varchar,
    intersection_or_approach_related boolean,
    number_of_approaches integer,
    within_interchange_area boolean,
    location_first_harmful_event varchar,
    manner_of_collision varchar,
    weather varchar,
    light_condition varchar,
    active_school_zone_related boolean,
    work_zone_related boolean,
    workers_present boolean,
    law_enforcement_present_in_work_zone boolean,
    work_zone_type varchar,
    work_zone_location varchar,
    narrative varchar,
    report_taken_by varchar,
    supplement boolean,
    crash_reported_date_time timestamptz,
    dispatched_date_time timestamptz,
    arrived_date_time timestamptz,
    scene_cleared_date_time timestamptz,
    other_investigation_time integer,
    total_time_roadway_closed integer,
    officer_name varchar,
    officer_badge_number varchar,
    checked_by_officer_name varchar,
    checked_by_badge_number varchar,
    roadway_divided boolean,
    divided_lane_travel_direction varchar,
    divided_median_type varchar,
    road_contour varchar,
    road_condition varchar,
    road_surface varchar,
    total_injured integer,
    total_killed integer,
    total_minutes integer,
    animal_related boolean,
    animal_deer_related boolean,
    alcohol_related boolean,
    drug_related boolean,
    bicycle_related boolean,
    motor_cycle_related boolean,
    speed_related boolean,
    pedestrian_related boolean,
    semi_truck_related boolean,
    small_truck_related boolean,
    youth_related boolean,
    teen_related boolean,
    dui21related boolean,
    senior_related boolean,
    fatal_not_reportable boolean,
    commercial_related boolean,
    commercial_at_fault boolean
);



-- It was discovered that one or more records have uneven numbered double-quotes
-- So had to create a "quote" character to create boundary for each field that is most likely not already used in the CSV file:
COPY oh.crash_statistics
FROM '/var/local/CrashStatistics.csv'
WITH (FORMAT CSV, HEADER, QUOTE E'\x01');


-- This record's local_information has uneven numbered double-quotes:
select * from oh.crash_statistics where local_information = 'P23041400001296';



-- Handy command to examine a specific row of the CSV file:
-- head -n 13512 CrashStatistics.csv | tail -n 1
